SELECT  
    F.FOLIO_TYPE DOC,
    F.BILL_NO CONS,
    F.TRX_DATE  F_FACTUR,
    F.TRX_DATE  F_CORTE,
    F.resort CIA,
    CASE WHEN N.ID_TYPE = '1' THEN '13' WHEN N.ID_TYPE = '3' THEN '41' 
    WHEN N.ID_TYPE = '5' THEN '22' WHEN N.ID_TYPE = '30' THEN '12' ELSE '31' END AS TIP,
    NVL(N.TAX1_NO, '222222223') AS TERCERO,
    T.ACCOUNT_NO AS NIT_EMP,
    T.ACCOUNT_NAME AS RAZON_SOCIAL_EMP,
    N.NAME_KEYWORDS SUC,
    N.NATIONALITY NAC,
    F.ORIGINAL_RESV_NAME_ID RESERV,
    F.trx_code COD,
    F.TRX_DATE  FECHA_T,
    REPLACE(F.TRX_AMOUNT, '.', ',') AS VALOR,
    F.ROOM HAB,
    F.BILL_NO FACTURA,
    F.TRX_NO,
    N.NAME_KEYWORDS RECIBO,
    N.FIRST NOMBRES,
    N.SNAME APELLIDOS,
    F.EXCHANGE_RATE TASADECAMBIO,
    F.CURRENCY TIPOMONEDA,
    F.CURRENCY TIPOMONEDA,
    N.ADDRESS1 ADDRESS1,
    N.PHONE_NO PHONE_NO,
    N.CITY CITY,
    N.COUNTRY COUNTRY,
    N.EMAIL EMAIL,
    '1102' CODE_POSTAL

FROM  
    FINANCIAL_TRANSACTIONS_E F
INNER JOIN 
    NAME_VIEW N 
    ON F.NAME_ID = N.NAME_ID
LEFT JOIN 
    ar_folio_tax T
    ON T.NAME_ID = F.NAME_ID
WHERE  
    F.NET_AMOUNT <> '0'
    AND F.TRX_DATE = TO_DATE('03-DEC-2024', 'DD-MON-YYYY')
    
    UNION ALL
    
    SELECT  
    F.FOLIO_TYPE DOC,
    F.BILL_NO CONS,
    F.TRX_DATE  F_FACTUR,
    F.TRX_DATE  F_CORTE,
    F.resort CIA,
    CASE WHEN N.ID_TYPE = '1' THEN '13' WHEN N.ID_TYPE = '3' THEN '41' 
    WHEN N.ID_TYPE = '5' THEN '22' WHEN N.ID_TYPE = '30' THEN '12' ELSE '31' END AS TIP,
    NVL(N.TAX1_NO, '222222223') AS TERCERO,
    T.ACCOUNT_NO AS NIT_EMP,
    T.ACCOUNT_NAME AS RAZON_SOCIAL_EMP,
    N.NAME_KEYWORDS SUC,
    N.NATIONALITY NAC,
    F.ORIGINAL_RESV_NAME_ID RESERV,
    F.trx_code COD,
    F.TRX_DATE  FECHA_T,
    REPLACE(F.TRX_AMOUNT, '.', ',') AS VALOR,
    F.ROOM HAB,
    F.BILL_NO FACTURA,
    F.TRX_NO,
    N.NAME_KEYWORDS RECIBO,
    N.FIRST NOMBRES,
    N.SNAME APELLIDOS,
    F.EXCHANGE_RATE TASADECAMBIO,
    F.CURRENCY TIPOMONEDA,
    F.CURRENCY TIPOMONEDA,
    N.ADDRESS1 ADDRESS1,
    N.PHONE_NO PHONE_NO,
    N.CITY CITY,
    N.COUNTRY COUNTRY,
    N.EMAIL EMAIL,
    '1102' CODE_POSTAL

FROM  
    FINANCIAL_TRANSACTIONS_E F
INNER JOIN 
    NAME_VIEW N 
    ON F.NAME_ID = N.NAME_ID
WHERE  
    F.TRX_DATE = TO_DATE('03-DEC-2024', 'DD-MON-YYYY')
    AND F.TRX_CODE <= '9000'
    AND F.TRX_CODE NOT IN ('8994', '90400')
    AND F.NET_AMOUNT <> '0'
    
    UNION
    
        SELECT  
    F.FOLIO_TYPE DOC,
    F.BILL_NO CONS,
    F.TRX_DATE  F_FACTUR,
    F.TRX_DATE  F_CORTE,
    F.resort CIA,
    CASE WHEN N.ID_TYPE = '1' THEN '13' WHEN N.ID_TYPE = '3' THEN '41' 
    WHEN N.ID_TYPE = '5' THEN '22' WHEN N.ID_TYPE = '30' THEN '12' ELSE '31' END AS TIP,
    NVL(N.TAX1_NO, '222222223') AS TERCERO,
    T.ACCOUNT_NO AS NIT_EMP,
    T.ACCOUNT_NAME AS RAZON_SOCIAL_EMP,
    N.NAME_KEYWORDS SUC,
    N.NATIONALITY NAC,
    F.ORIGINAL_RESV_NAME_ID RESERV,
    F.trx_code COD,
    F.TRX_DATE  FECHA_T,
    REPLACE(F.TRX_AMOUNT, '.', ',') AS VALOR,
    F.ROOM HAB,
    F.BILL_NO FACTURA,
    F.TRX_NO,
    N.NAME_KEYWORDS RECIBO,
    N.FIRST NOMBRES,
    N.SNAME APELLIDOS,
    F.EXCHANGE_RATE TASADECAMBIO,
    F.CURRENCY TIPOMONEDA,
    F.CURRENCY TIPOMONEDA,
    N.ADDRESS1 ADDRESS1,
    N.PHONE_NO PHONE_NO,
    N.CITY CITY,
    N.COUNTRY COUNTRY,
    N.EMAIL EMAIL,
    '1102' CODE_POSTAL

FROM  
    FINANCIAL_TRANSACTIONS_E F
INNER JOIN 
    NAME_VIEW N 
    ON F.NAME_ID = N.NAME_ID
WHERE  
        F.TRX_DATE = TO_DATE('03-DEC-2024', 'DD-MON-YYYY') 
        AND F.TRX_CODE >= '9000';